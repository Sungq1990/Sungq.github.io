<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>尐海的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="尐海的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="尐海的博客">
<meta property="og:url" content="https://sgq.github.io/index.html">
<meta property="og:site_name" content="尐海的博客">
<meta property="og:description" content="尐海的博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="sgq">
<meta property="article:tag" content="php,mysql,docker,nginx,redis.linux">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="尐海的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">尐海的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">博客</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://sgq.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-CentOS安装Ruby" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/01/04/CentOS%E5%AE%89%E8%A3%85Ruby/" class="article-date">
  <time class="dt-published" datetime="2023-01-04T10:45:00.000Z" itemprop="datePublished">2023-01-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/01/04/CentOS%E5%AE%89%E8%A3%85Ruby/">CentOS安装Ruby</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近一个项目是用Ruby写的，需要自己搭建Ruby环境，这里记录一下搭建过程<br>安装的是2.6.5版本的Ruby，编译安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">下载ruby安装包</span><br><span class="line">wget https://cache.ruby-china.com/pub/ruby/ruby-2.6.5.tar.xz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">解压安装包</span><br><span class="line">xz -d ruby-2.6.5.tar.xz</span><br><span class="line">tar -xvf ruby-2.6.5.tar</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">编译安装 </span><br><span class="line">cd /ruby-2.6.5</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p>ruby依赖zlib、openssl-devel、readline等，需要是用yum安装相应的软件，然后分别进&#x2F;ruby-2.6.5&#x2F;ext&#x2F;zlib、<br>&#x2F;ruby-2.6.5&#x2F;ext&#x2F;openssl</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ruby ./extconf.rb</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p>这样ruby就会安上相应的扩展</p>
<p>安装扩展的时候可能会报make:*** No rule to make target <code>/include/ruby.h&#39;, needed by </code>zlib.o’.Stop.</p>
<p>这个报错是指找不到&#x2F;include&#x2F;ruby.h这个文件，只要修改各自对应的Makefile脚本文件最上面加上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top_srcdir = ../..</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2023/01/04/CentOS%E5%AE%89%E8%A3%85Ruby/" data-id="clpgmy4t30001o1vhcf92cymo" data-title="CentOS安装Ruby" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/" rel="tag">Ruby</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-nginx反向代理重复请求问题" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/02/nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E9%87%8D%E5%A4%8D%E8%AF%B7%E6%B1%82%E9%97%AE%E9%A2%98/" class="article-date">
  <time class="dt-published" datetime="2022-06-02T09:55:00.000Z" itemprop="datePublished">2022-06-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/06/02/nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E9%87%8D%E5%A4%8D%E8%AF%B7%E6%B1%82%E9%97%AE%E9%A2%98/">nginx反向代理重复请求问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  今天发现公司一个发邮件的接口执行了两次，通过日志发现是http请求请求了2次，</span><br><span class="line">但是实际上用户只操作了1次。并且第2次请求距离第1次基本上有60秒的间隔，所以</span><br><span class="line">怀疑是nginx配置的问题。经过百度发现是nginx反向代理的问题。</span><br><span class="line">  由于这个接口需要发Excel邮件，所以执行时间会比较长，肯定是超过60秒的。</span><br><span class="line">nginx反向代理当一台机器超过设置的超时时间还没返回时，会把请求发送到另外一台</span><br><span class="line">机器上重试，这是nginx的容错机制。</span><br><span class="line">  如何解决,主要是nginx3个配置。</span><br><span class="line">  proxy_connect_timeout:超时时间</span><br><span class="line">  proxy_next_upstream:定义了什么情况下进⾏重试</span><br><span class="line">  proxy_next_upstream_tries:重试的次数</span><br><span class="line">  至于如何解决这个问题就需要结合业务自己做处理了，直接去掉这个机制肯定是不行的，</span><br><span class="line">我这边的做法是将这种耗时请求都异步处理了。</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2022/06/02/nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E9%87%8D%E5%A4%8D%E8%AF%B7%E6%B1%82%E9%97%AE%E9%A2%98/" data-id="clpgmy4tq001qo1vh4d4g4ln7" data-title="nginx反向代理重复请求问题" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/" rel="tag">nginx 反向代理</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Method __PHP_Incomplete_Class--handle() does not exist" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/17/Method%20__PHP_Incomplete_Class--handle()%20does%20not%20exist/" class="article-date">
  <time class="dt-published" datetime="2022-03-17T10:10:00.000Z" itemprop="datePublished">2022-03-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/03/17/Method%20__PHP_Incomplete_Class--handle()%20does%20not%20exist/">laravel job报错</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">执行job任务时报Method __PHP_Incomplete_Class::handle() does not exist，</span><br><span class="line">原因就是一台机器同时跑多个laravel项目，并且有多个项目有job任务，就会冲突</span><br><span class="line">解决方法就是修改queue.php下面的配置</span><br><span class="line">如果是走数据库的就改database.queue 改个名字，同理redis就改redis下面的queue</span><br><span class="line">比如把queue=&gt;default 改成 queue=&gt;default_1</span><br><span class="line">然后修改php artisan queue:work  --queue=default_1 即可</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2022/03/17/Method%20__PHP_Incomplete_Class--handle()%20does%20not%20exist/" data-id="clpgmy4tc000mo1vh21ch8jts" data-title="laravel job报错" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/laravel-php-job/" rel="tag">laravel php job</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-curl提示Connection refused问题" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/24/curl%E6%8F%90%E7%A4%BAConnection%20refused%E9%97%AE%E9%A2%98/" class="article-date">
  <time class="dt-published" datetime="2022-01-24T07:31:00.000Z" itemprop="datePublished">2022-01-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/01/24/curl%E6%8F%90%E7%A4%BAConnection%20refused%E9%97%AE%E9%A2%98/">curl提示Connection refused问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>装了clash后发现终端执行curl不行了，会报下面的错误</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl: (7) Failed to connect to 127.0.0.1 port 1080: Connection refused</span><br></pre></td></tr></table></figure>

<p>解决方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">修改curl的配置文件</span><br><span class="line">配置文件一般位于 ~/.curlrc</span><br><span class="line">发现里面有一行代理配置 socks5 = &quot;127.0.0.1:1080&quot;</span><br><span class="line">注释掉就行</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2022/01/24/curl%E6%8F%90%E7%A4%BAConnection%20refused%E9%97%AE%E9%A2%98/" data-id="clpgmy4ti0013o1vh0fhn1waj" data-title="curl提示Connection refused问题" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Deployer-php/" rel="tag">Deployer php</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Mac Clash Chrome无痕模式可以，正常模式不行的问题" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/10/Mac%20Clash%20Chrome%E6%97%A0%E7%97%95%E6%A8%A1%E5%BC%8F%E5%8F%AF%E4%BB%A5%EF%BC%8C%E6%AD%A3%E5%B8%B8%E6%A8%A1%E5%BC%8F%E4%B8%8D%E8%A1%8C%E7%9A%84%E9%97%AE%E9%A2%98/" class="article-date">
  <time class="dt-published" datetime="2022-01-10T06:26:54.000Z" itemprop="datePublished">2022-01-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/01/10/Mac%20Clash%20Chrome%E6%97%A0%E7%97%95%E6%A8%A1%E5%BC%8F%E5%8F%AF%E4%BB%A5%EF%BC%8C%E6%AD%A3%E5%B8%B8%E6%A8%A1%E5%BC%8F%E4%B8%8D%E8%A1%8C%E7%9A%84%E9%97%AE%E9%A2%98/">Mac Clash Chrome无痕模式可以，正常模式不行的问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>现象描述</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安装了Clash，safari可以正常使用，chrome下无痕模式可以，正常模式就不行</span><br></pre></td></tr></table></figure>

<p>解决方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">先chrome安装一个SwitchyOmega插件(可以离线安装，自行搜索方法)</span><br><span class="line">然后在SwitchyOmega下的情景模式中配置代理服务器</span><br><span class="line">代理服务器填127.0.0.1</span><br><span class="line">端口填7890(如果改过Clash的端口，就填修改后的那个)</span><br><span class="line">然后选择proxy模式就可以了</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2022/01/10/Mac%20Clash%20Chrome%E6%97%A0%E7%97%95%E6%A8%A1%E5%BC%8F%E5%8F%AF%E4%BB%A5%EF%BC%8C%E6%AD%A3%E5%B8%B8%E6%A8%A1%E5%BC%8F%E4%B8%8D%E8%A1%8C%E7%9A%84%E9%97%AE%E9%A2%98/" data-id="clpgmy4tb000jo1vh2k3re386" data-title="Mac Clash Chrome无痕模式可以，正常模式不行的问题" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Clash-Chrome/" rel="tag">Clash Chrome</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-PHP Library not loade libldap-2.4.2.dylib问题" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/12/30/PHP%20Library%20not%20loade%20libldap-2.4.2.dylib%E9%97%AE%E9%A2%98/" class="article-date">
  <time class="dt-published" datetime="2021-12-30T06:22:00.000Z" itemprop="datePublished">2021-12-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/12/30/PHP%20Library%20not%20loade%20libldap-2.4.2.dylib%E9%97%AE%E9%A2%98/">PHP Library not loade libldap-2.4.2.dylib问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>先说下我的环境，机器是Mac，系统是Monterey 12.0.1，之前用的brew安装的<a href="mailto:&#x70;&#x68;&#112;&#64;&#x37;&#x2e;&#50;">&#x70;&#x68;&#112;&#64;&#x37;&#x2e;&#50;</a></p>
<p>可能是之前用brew安装了ffmpeg导致PHP的CLI环境出问题了，在CLI下执行PHP会报</p>
<p>Library not loaded: &#x2F;usr&#x2F;local&#x2F;opt&#x2F;openldap&#x2F;lib&#x2F;libldap-2.4.2.dylib</p>
<p>说下解决方法，就是需要brew重装下php才行</p>
<p>由于我的brew之前重装过，直接执行brew reinstall <a href="mailto:&#112;&#104;&#x70;&#x40;&#x37;&#x2e;&#x32;">&#112;&#104;&#x70;&#x40;&#x37;&#x2e;&#x32;</a>会报错</p>
<p>Error: <a href="mailto:&#112;&#104;&#112;&#64;&#55;&#x2e;&#50;">&#112;&#104;&#112;&#64;&#55;&#x2e;&#50;</a> has been disabled because it is deprecated upstream!</p>
<p>需要执行下<br>brew tap shivammathur&#x2F;php<br>在执行<br>brew install shivammathur&#x2F;php&#x2F;<a href="mailto:&#112;&#104;&#x70;&#64;&#55;&#x2e;&#50;">&#112;&#104;&#x70;&#64;&#55;&#x2e;&#50;</a><br>即可</p>
<p>安装完成后问题得到解决！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2021/12/30/PHP%20Library%20not%20loade%20libldap-2.4.2.dylib%E9%97%AE%E9%A2%98/" data-id="clpgmy4tg0010o1vh5fdic97c" data-title="PHP Library not loade libldap-2.4.2.dylib问题" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Laravel的TrimStrings中间件会把请求数据的首尾空格去掉" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/11/Laravel%E7%9A%84TrimStrings%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%BC%9A%E6%8A%8A%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE%E7%9A%84%E9%A6%96%E5%B0%BE%E7%A9%BA%E6%A0%BC%E5%8E%BB%E6%8E%89/" class="article-date">
  <time class="dt-published" datetime="2021-10-11T09:18:00.000Z" itemprop="datePublished">2021-10-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/11/Laravel%E7%9A%84TrimStrings%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%BC%9A%E6%8A%8A%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE%E7%9A%84%E9%A6%96%E5%B0%BE%E7%A9%BA%E6%A0%BC%E5%8E%BB%E6%8E%89/">Laravel的TrimStrings中间件会把请求数据的首尾空格去掉</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">今天业务方反馈一个运行很久了的接口报签名错误，经过定位发现是post提交的</span><br><span class="line">参数中某个字段尾部有个空格，业务方在生成签名的时候是带上空格的，到我这边</span><br><span class="line">的时候发现没有空格了，经过搜索引擎的帮助发现是Larave的TrimStrings中</span><br><span class="line">间件造成的。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">两种解决办法：</span><br><span class="line">一种是业务方对数据进行处理去掉首尾空格；</span><br><span class="line">二是注释掉TrimStrings这个中间件</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2021/10/11/Laravel%E7%9A%84TrimStrings%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%BC%9A%E6%8A%8A%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE%E7%9A%84%E9%A6%96%E5%B0%BE%E7%A9%BA%E6%A0%BC%E5%8E%BB%E6%8E%89/" data-id="clpgmy4t9000bo1vh7du6bjyw" data-title="Laravel的TrimStrings中间件会把请求数据的首尾空格去掉" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Laravel-TrimStrings/" rel="tag">Laravel TrimStrings</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Html5 Ruby标签" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/02/Html5%20Ruby%E6%A0%87%E7%AD%BE/" class="article-date">
  <time class="dt-published" datetime="2021-09-02T06:09:54.000Z" itemprop="datePublished">2021-09-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/02/Html5%20Ruby%E6%A0%87%E7%AD%BE/">Html5 Ruby标签</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>网上看到的，第一次知道这个标签原来是用来显示拼音的…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;ruby&gt;</span><br><span class="line">  汉 &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;han&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;</span><br><span class="line">  字 &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;zi&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;</span><br><span class="line">&lt;/ruby&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/02/qWYVObD8txkAcsK.png" alt="效果图"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2021/09/02/Html5%20Ruby%E6%A0%87%E7%AD%BE/" data-id="clpgmy4t70008o1vh2i4b0dd6" data-title="Html5 Ruby标签" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby%E6%A0%87%E7%AD%BE/" rel="tag">Ruby标签</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Laravel ORM操作大量数据时慢" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/19/Laravel%20ORM%E6%93%8D%E4%BD%9C%E5%A4%A7%E9%87%8F%E6%95%B0%E6%8D%AE%E6%97%B6%E6%85%A2/" class="article-date">
  <time class="dt-published" datetime="2021-08-19T05:58:00.000Z" itemprop="datePublished">2021-08-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/19/Laravel%20ORM%E6%93%8D%E4%BD%9C%E5%A4%A7%E9%87%8F%E6%95%B0%E6%8D%AE%E6%97%B6%E6%85%A2/">Laravel ORM操作大量数据时慢</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">今天越到一个问题，一个接口执行了将近15s，接口逻辑很简单就执行一条sql然后把结果返回，</span><br><span class="line">但是通过debug软件跟踪发现瓶颈不在数据库。后面通过研究发现瓶颈在框架的ORM，因为这个sql</span><br><span class="line">返回了上万条数据，当数据量巨大时ORM就会变得非常慢，这个时候需要直接用原生方法。</span><br></pre></td></tr></table></figure>

<h4 id="使用orm"><a href="#使用orm" class="headerlink" title="使用orm"></a>使用orm</h4><p><img src="https://i.loli.net/2021/08/19/93NZCUlsjzVStxu.png"></p>
<h4 id="使用原生sql"><a href="#使用原生sql" class="headerlink" title="使用原生sql"></a>使用原生sql</h4><p><img src="https://i.loli.net/2021/08/19/bTX49RaV7KMFv5G.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可以看到使用原生sql后TTFB从15s缩减到不到1s，整个接口的速度有了质的提升</span><br><span class="line">所以处理大数据量的时候建议直接用原生sql，不要用orm</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2021/08/19/Laravel%20ORM%E6%93%8D%E4%BD%9C%E5%A4%A7%E9%87%8F%E6%95%B0%E6%8D%AE%E6%97%B6%E6%85%A2/" data-id="clpgmy4t80009o1vhdashdnsp" data-title="Laravel ORM操作大量数据时慢" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Laravel-ORM/" rel="tag">Laravel ORM</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Hexo yilia主题翻页优化" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/13/Hexo%20yilia%E4%B8%BB%E9%A2%98%E7%BF%BB%E9%A1%B5%E4%BC%98%E5%8C%96/" class="article-date">
  <time class="dt-published" datetime="2021-08-13T03:30:54.000Z" itemprop="datePublished">2021-08-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/13/Hexo%20yilia%E4%B8%BB%E9%A2%98%E7%BF%BB%E9%A1%B5%E4%BC%98%E5%8C%96/">Hexo yilia主题翻页优化</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="未优化前"><a href="#未优化前" class="headerlink" title="未优化前"></a>未优化前</h4><p><img src="https://i.loli.net/2021/08/13/NVctIzELo4y9eCP.png"></p>
<h4 id="优化后"><a href="#优化后" class="headerlink" title="优化后"></a>优化后</h4><p><img src="https://i.loli.net/2021/08/13/4a7gRIslzymeU5p.png"></p>
<h4 id="改动过程"><a href="#改动过程" class="headerlink" title="改动过程"></a>改动过程</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">首先</span><br><span class="line">/themes/yilia/layout/_partial/archive.ejs</span><br><span class="line">全文搜索 &amp;laquo; Prev和 Next &amp;raquo 并改成 上一页和下一页</span><br><span class="line">改js总共要改两处地方</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">最后</span><br><span class="line">/themes/yilia/layout/_partial/script.ejs</span><br><span class="line">删除该文件里的Next &amp;raquo 和 &amp;laquo; Prev</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgq.github.io/2021/08/13/Hexo%20yilia%E4%B8%BB%E9%A2%98%E7%BF%BB%E9%A1%B5%E4%BC%98%E5%8C%96/" data-id="clpgmy4t60005o1vhgr267tmw" data-title="Hexo yilia主题翻页优化" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo-yilia/" rel="tag">hexo yilia</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Clash-Chrome/" rel="tag">Clash Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Deployer-php/" rel="tag">Deployer php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Graylog/" rel="tag">Graylog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Laravel-ORM/" rel="tag">Laravel ORM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Laravel-TrimStrings/" rel="tag">Laravel TrimStrings</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux-expect/" rel="tag">Linux expect</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis/" rel="tag">Mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Opcache/" rel="tag">Opcache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Phan/" rel="tag">Phan</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ruby/" rel="tag">Ruby</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ruby%E6%A0%87%E7%AD%BE/" rel="tag">Ruby标签</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sublime/" rel="tag">Sublime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/" rel="tag">golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo-yilia/" rel="tag">hexo yilia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/laravel/" rel="tag">laravel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/laravel-php-job/" rel="tag">laravel php job</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/" rel="tag">life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maatwebsite/" rel="tag">maatwebsite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongo/" rel="tag">mongo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx-gzip-brotli/" rel="tag">nginx gzip brotli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx-logrotate-goaccess/" rel="tag">nginx logrotate goaccess</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/" rel="tag">nginx 反向代理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oss-%E9%98%BF%E9%87%8C%E4%BA%91/" rel="tag">oss 阿里云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php-EasyWeChat/" rel="tag">php EasyWeChat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php-Larvel-Job/" rel="tag">php Larvel Job</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php-MongoDB/" rel="tag">php MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php-fpm/" rel="tag">php-fpm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phpspy/" rel="tag">phpspy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/satis-composer-webhook/" rel="tag">satis composer webhook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/soar-mysql/" rel="tag">soar mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%83%E7%89%9B/" rel="tag">七牛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F-vue-mpvue-php-%E6%9D%AD%E5%B7%9E%E6%91%87%E5%8F%B7/" rel="tag">小程序 vue mpvue php 杭州摇号</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Clash-Chrome/" style="font-size: 10px;">Clash Chrome</a> <a href="/tags/Deployer-php/" style="font-size: 13.33px;">Deployer php</a> <a href="/tags/Graylog/" style="font-size: 10px;">Graylog</a> <a href="/tags/Laravel-ORM/" style="font-size: 10px;">Laravel ORM</a> <a href="/tags/Laravel-TrimStrings/" style="font-size: 10px;">Laravel TrimStrings</a> <a href="/tags/Linux-expect/" style="font-size: 10px;">Linux expect</a> <a href="/tags/Mybatis/" style="font-size: 10px;">Mybatis</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/Opcache/" style="font-size: 10px;">Opcache</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/Phan/" style="font-size: 10px;">Phan</a> <a href="/tags/Ruby/" style="font-size: 10px;">Ruby</a> <a href="/tags/Ruby%E6%A0%87%E7%AD%BE/" style="font-size: 10px;">Ruby标签</a> <a href="/tags/Sublime/" style="font-size: 10px;">Sublime</a> <a href="/tags/git/" style="font-size: 13.33px;">git</a> <a href="/tags/golang/" style="font-size: 10px;">golang</a> <a href="/tags/hexo-yilia/" style="font-size: 10px;">hexo yilia</a> <a href="/tags/java/" style="font-size: 13.33px;">java</a> <a href="/tags/laravel/" style="font-size: 10px;">laravel</a> <a href="/tags/laravel-php-job/" style="font-size: 10px;">laravel php job</a> <a href="/tags/life/" style="font-size: 10px;">life</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/maatwebsite/" style="font-size: 10px;">maatwebsite</a> <a href="/tags/mongo/" style="font-size: 10px;">mongo</a> <a href="/tags/mysql/" style="font-size: 20px;">mysql</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/nginx-gzip-brotli/" style="font-size: 10px;">nginx gzip brotli</a> <a href="/tags/nginx-logrotate-goaccess/" style="font-size: 10px;">nginx logrotate goaccess</a> <a href="/tags/nginx-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/" style="font-size: 10px;">nginx 反向代理</a> <a href="/tags/oss-%E9%98%BF%E9%87%8C%E4%BA%91/" style="font-size: 10px;">oss 阿里云</a> <a href="/tags/php/" style="font-size: 16.67px;">php</a> <a href="/tags/php-EasyWeChat/" style="font-size: 10px;">php EasyWeChat</a> <a href="/tags/php-Larvel-Job/" style="font-size: 10px;">php Larvel Job</a> <a href="/tags/php-MongoDB/" style="font-size: 10px;">php MongoDB</a> <a href="/tags/php-fpm/" style="font-size: 10px;">php-fpm</a> <a href="/tags/phpspy/" style="font-size: 10px;">phpspy</a> <a href="/tags/satis-composer-webhook/" style="font-size: 10px;">satis composer webhook</a> <a href="/tags/soar-mysql/" style="font-size: 10px;">soar mysql</a> <a href="/tags/%E4%B8%83%E7%89%9B/" style="font-size: 10px;">七牛</a> <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F-vue-mpvue-php-%E6%9D%AD%E5%B7%9E%E6%91%87%E5%8F%B7/" style="font-size: 10px;">小程序 vue mpvue php 杭州摇号</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/01/04/CentOS%E5%AE%89%E8%A3%85Ruby/">CentOS安装Ruby</a>
          </li>
        
          <li>
            <a href="/2022/06/02/nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E9%87%8D%E5%A4%8D%E8%AF%B7%E6%B1%82%E9%97%AE%E9%A2%98/">nginx反向代理重复请求问题</a>
          </li>
        
          <li>
            <a href="/2022/03/17/Method%20__PHP_Incomplete_Class--handle()%20does%20not%20exist/">laravel job报错</a>
          </li>
        
          <li>
            <a href="/2022/01/24/curl%E6%8F%90%E7%A4%BAConnection%20refused%E9%97%AE%E9%A2%98/">curl提示Connection refused问题</a>
          </li>
        
          <li>
            <a href="/2022/01/10/Mac%20Clash%20Chrome%E6%97%A0%E7%97%95%E6%A8%A1%E5%BC%8F%E5%8F%AF%E4%BB%A5%EF%BC%8C%E6%AD%A3%E5%B8%B8%E6%A8%A1%E5%BC%8F%E4%B8%8D%E8%A1%8C%E7%9A%84%E9%97%AE%E9%A2%98/">Mac Clash Chrome无痕模式可以，正常模式不行的问题</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 sgq<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>